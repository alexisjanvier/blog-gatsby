<!DOCTYPE html>
 <html><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><link rel="preload" href="/component---src-layouts-index-js-1aff9b948102432e696a.js" as="script"/><link rel="preload" href="/component---src-templates-blog-post-js-27ab818cb474ecdb579f.js" as="script"/><link rel="preload" href="/path---deploiement-continu-vers-s-3-5f69fa5c5d1b092bf7c1.js" as="script"/><link rel="preload" href="/app-ac00f5ba7dd730d73fb0.js" as="script"/><link rel="preload" href="/commons-f1873a4f7ee992bae8f1.js" as="script"/><script id="webpack-manifest">
            //<![CDATA[
            window.webpackManifest = {"15178676390636814000":"app-ac00f5ba7dd730d73fb0.js","7065993314207131000":"component---src-templates-blog-post-js-27ab818cb474ecdb579f.js","17287813538477107000":"component---src-pages-about-js-9c5b461fd143566c6dcb.js","2345137460201621000":"component---src-pages-index-js-0f1ab3197480b8c0554e.js","3954140758598355500":"path----b67ec03a2eef0f074187.js","6607528598080297000":"path---deploiement-continu-vers-s-3-5f69fa5c5d1b092bf7c1.js","9886222006147854000":"path---road-to-caen-le-projet-c2d71750cade2d45dd41.js","14293067044874177000":"path---une-console-sous-windows-82bece36faaa203410b3.js","10739084472686977000":"path---yarn-97fc7575b09c3a5c74f3.js","3438921928302362600":"path---bootstrapping-du-projet-en-es-6-7a41039d1bcd333ae943.js","17953591736895156000":"path---about-a0e39f21c11f6a62c5ab.js","9347362237655822000":"path---index-c405d56e62caea3b93ab.js","7489246917808536000":"component---src-layouts-index-js-1aff9b948102432e696a.js"}
            //]]>
            </script><style id="typography.js">html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{font:125%/1.5em 'PT Sans','sans-serif';box-sizing:border-box;overflow-y:scroll;}*{box-sizing:inherit;}*:before{box-sizing:inherit;}*:after{box-sizing:inherit;}body{color:hsla(0,0%,0%,0.8);font-family:'PT Sans','sans-serif';font-weight:400;word-wrap:break-word;font-kerning:normal;-moz-font-feature-settings:"kern", "liga", "clig", "calt";-ms-font-feature-settings:"kern", "liga", "clig", "calt";-webkit-font-feature-settings:"kern", "liga", "clig", "calt";font-feature-settings:"kern", "liga", "clig", "calt";}img{max-width:100%;margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;}h1{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;color:hsla(0,0%,0%,0.9);font-family:'Oswald','sans-serif';font-weight:700;text-rendering:optimizeLegibility;font-size:2rem;line-height:1.1;}h2{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;color:hsla(0,0%,0%,0.9);font-family:'Oswald','sans-serif';font-weight:700;text-rendering:optimizeLegibility;font-size:1.51572rem;line-height:1.1;}h3{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;color:hsla(0,0%,0%,0.9);font-family:'Oswald','sans-serif';font-weight:700;text-rendering:optimizeLegibility;font-size:1.31951rem;line-height:1.1;}h4{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;color:hsla(0,0%,0%,0.9);font-family:'Oswald','sans-serif';font-weight:700;text-rendering:optimizeLegibility;font-size:1rem;line-height:1.1;}h5{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;color:hsla(0,0%,0%,0.9);font-family:'Oswald','sans-serif';font-weight:700;text-rendering:optimizeLegibility;font-size:0.87055rem;line-height:1.1;}h6{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;color:hsla(0,0%,0%,0.9);font-family:'Oswald','sans-serif';font-weight:700;text-rendering:optimizeLegibility;font-size:0.81225rem;line-height:1.1;}hgroup{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;}ul{margin-left:1.5rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;list-style-position:outside;list-style-image:none;}ol{margin-left:1.5rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;list-style-position:outside;list-style-image:none;}dl{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;}dd{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;}p{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;}figure{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;}pre{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;font-size:0.85rem;line-height:1.5rem;}table{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;font-size:1rem;line-height:1.5rem;border-collapse:collapse;width:100%;}fieldset{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;}blockquote{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0.9375rem;padding-right:0;padding-top:0;margin-bottom:1.5rem;font-size:1.1487rem;line-height:1.5rem;border-left:0.5625rem solid #292d35;color:hsla(0,0%,0%,0.65);font-style:italic;}form{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;}noscript{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;}iframe{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;}hr{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:calc(1.5rem - 1px);background:hsla(0,0%,0%,0.2);border:none;height:1px;}address{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;}b{font-weight:700;}strong{font-weight:700;}dt{font-weight:700;}th{font-weight:700;}li{margin-bottom:calc(1.5rem / 2);}ol li{padding-left:0;}ul li{padding-left:0;}li > ol{margin-left:1.5rem;margin-bottom:calc(1.5rem / 2);margin-top:calc(1.5rem / 2);}li > ul{margin-left:1.5rem;margin-bottom:calc(1.5rem / 2);margin-top:calc(1.5rem / 2);}blockquote *:last-child{margin-bottom:0;}li *:last-child{margin-bottom:0;}p *:last-child{margin-bottom:0;}li > p{margin-bottom:calc(1.5rem / 2);}code{font-size:0.85rem;line-height:1.5rem;}kbd{font-size:0.85rem;line-height:1.5rem;}samp{font-size:0.85rem;line-height:1.5rem;}abbr{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}acronym{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}abbr[title]{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;text-decoration:none;}thead{text-align:left;}td,th{text-align:left;border-bottom:1px solid hsla(0,0%,0%,0.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding-left:1rem;padding-right:1rem;padding-top:0.75rem;padding-bottom:calc(0.75rem - 1px);}th:first-child,td:first-child{padding-left:0;}th:last-child,td:last-child{padding-right:0;}a{color:#292d35;text-decoration:none;text-shadow:.03em 0 #fff,-.03em 0 #fff,0 .03em #fff,0 -.03em #fff,.06em 0 #fff,-.06em 0 #fff,.09em 0 #fff,-.09em 0 #fff,.12em 0 #fff,-.12em 0 #fff,.15em 0 #fff,-.15em 0 #fff;background-image:linear-gradient(to top, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0) 1px, #292d35 1px, #292d35 2px, rgba(0, 0, 0, 0) 2px);}a:hover,a:active{text-shadow:none;background-image:none;}h1,h2,h3,h4,h5,h6{margin-top:3rem;}blockquote > :last-child{margin-bottom:0;}blockquote cite{font-size:1rem;line-height:1.5rem;color:hsla(0,0%,0%,0.8);font-style:normal;font-weight:400;}blockquote cite:before{content:"— ";}@media only screen and (max-width:480px){html{font-size:106.25%;line-height:1.45em;}blockquote{border-left:0.28125rem solid #292d35;color:hsla(0,0%,0%,0.59);padding-left:0.84375rem;font-style:italic;margin-left:-1.125rem;margin-right:0;}}</style><link href="//fonts.googleapis.com/css?family=Oswald:700|PT+Sans:400,400i,700" rel="stylesheet" type="text/css"/><title data-react-helmet="true">Déploiement continu vers S3</title><meta data-react-helmet="true" name="author" content="Àlexis Janvier"/><meta data-react-helmet="true" name="description" content="L’application « Road to Caen » est maintenant bootstrappée. Avant de commencer le développement proprement, il reste à mettre en place le tunnel de déploiement continu, du code créé en local au bucket S3 d’hébergement, déploiement sécurisé par l’exécution automatique des tests unitaires et fonctionnels déjà mis en place."/><meta data-react-helmet="true" name="keywords" content="AWS,S3,Devops"/><link rel="sitemap" type="application/xml" href="/sitemap.xml"/><script>
  !function(e,t,r){function n(){for(;d[0]&&"loaded"==d[0][f];)c=d.shift(),c[o]=!i.parentNode.insertBefore(c,i)}for(var s,a,c,d=[],i=e.scripts[0],o="onreadystatechange",f="readyState";s=r.shift();)a=e.createElement(t),"async"in i?(a.async=!1,e.head.appendChild(a)):i[f]?(d.push(a),a[o]=n):e.write("<"+t+' src="'+s+'" defer></'+t+">"),a.src=s}(document,"script",[
  "/commons-f1873a4f7ee992bae8f1.js","/app-ac00f5ba7dd730d73fb0.js","/path---deploiement-continu-vers-s-3-5f69fa5c5d1b092bf7c1.js","/component---src-templates-blog-post-js-27ab818cb474ecdb579f.js","/component---src-layouts-index-js-1aff9b948102432e696a.js"
])
  </script><style id="gatsby-inlined-css">header h3,header h5{display:inline-block;padding-right:.5rem;margin-top:0}header a{text-shadow:none;background-image:none;text-decoration:none;vertical-align:middle}header a:hover{color:red}header a img{vertical-align:middle}.blog-list h2,.blog-list h4{margin-bottom:.5rem}.blog-list h4{font-style:italic;margin-top:0}.blog-list h4 span{display:inline-block;color:grey;font-size:.8rem}.postIntro h1{font-size:2.5rem;width:100%;text-align:center;margin-top:1rem;margin-bottom:.5rem}.postIntro p.tags{font-size:.8rem;color:gray}.postIntro p.date,.postIntro p.tags{margin:0;text-align:center}.postIntro p.intro{margin-top:1.5rem;font-style:italic}code[class*=language-],pre[class*=language-]{color:#ccc;background:none;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#2d2d2d}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.block-comment,.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#999}.token.punctuation{color:#ccc}.token.attr-name,.token.deleted,.token.namespace,.token.tag{color:#e2777a}.token.function-name{color:#6196cc}.token.boolean,.token.function,.token.number{color:#f08d49}.token.class-name,.token.constant,.token.property,.token.symbol{color:#f8c555}.token.atrule,.token.builtin,.token.important,.token.keyword,.token.selector{color:#cc99cd}.token.attr-value,.token.char,.token.regex,.token.string,.token.variable{color:#7ec699}.token.entity,.token.operator,.token.url{color:#67cdcc}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.token.inserted{color:green}</style></head><body><div id="___gatsby"><div style="margin:0 auto;max-width:1000px;padding:1.25rem 1rem;" data-reactroot="" data-reactid="1" data-react-checksum="1304885240"><!-- react-empty: 2 --><header style="margin-bottom:1.5rem;" data-reactid="3"><a href="/" data-reactid="4"><h3 data-reactid="5">This is not &#x27;Nam.</h3><h5 data-reactid="6">This is my blog. There are rules.</h5></a><ul style="list-style:none;float:right;" data-reactid="7"><li style="display:inline-block;margin-right:1rem;" data-reactid="8"><a href="/" data-reactid="9">Blog</a></li><li style="display:inline-block;margin-right:1rem;" data-reactid="10"><a href="/about/" data-reactid="11">About</a></li><li style="display:inline-block;margin-right:1rem;" data-reactid="12"><a href="https://twitter.com/alexisjanvier" data-reactid="13"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAQAAADZc7J/AAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAAAjcAAAI3AfcGRMIAAAAHdElNRQfhCQEKGCQX757NAAACjElEQVRIx62VX0hTURzHP/e6NRkYLREcrLeCfFDBGL4UiWGJL+sP9FLkQ4FR7MGHhHTe251OqRBJX6qXIBDCelCQIAYS9CSVBCsHFT3EaIIxs8HYmnp72N28/zYn+Hs653fO93Pv7/x+5/wEFatNu9Y71QBNePECSZLEhXnPYjBn3SuYAWPevMQV6my4aWac4cFkBYBSS4h+3JS3DJOMyllbgNLIHO3sbkucl1ctgJHm7df4qpADJMSe4ZgBoDTyvmo5QAJ/4S9ELfa5PcnBx5xSWwIQqhj7Jo+Fy5wRBvgBQIy/QDshLYQxb/67dvKPOEWbSZ7inPyhMHxQl72lRnHzrpAR59HBpAh5qZS4Wbr4aALcLsphIC3d5w+XeAOAOy+BMOVKrZXK5oicmHalJAZwaJ4N2YOp1sIB9ZW2nj7cIK536qruJARz8pDYxlM2APhslo+cUGdL+Lr1TlEN6FZ7X9YADMfkPhqFs/SzYD7RbT8HdmZqwEGTbjUWv8GTwlDOEiVqk5MWw6zJgVc3fSEt71oBrYaZVzQAru8qF2g2A/TWp1ysrB89br7oIvr7XcNzZWK8oTxgK2JyJI0AyPDw7lo5udLNBSsgbnA08AzBXj7tYsrijIvCvMnVrSyH7yg2dzM1yDHLmc6LnkXSJm+r2oJo3qqEkCzMtGfREcwpM9wE4Be/WeELC/In477x+n8T9NpENRPMOcAZzl/DDRxklkn5p+nLh7jKPept5BlnWHvSlFGGNOcmUVaEb3xVt/Dh4zRdOMskJSKHioBa3lb1HuttiQ45u1+PKsirYg+J6uViT7EzlNI1HMPPUpU/7y92BfT5llfpIEKmojhDhI6dvrTfzbVoe2nv/wH5+trdc83aGwAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxNy0wOS0wMVQxMDoyNDozNiswMjowMORVb1wAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTctMDktMDFUMTA6MjQ6MzYrMDI6MDCVCNfgAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAAA10RVh0VGl0bGUAVHdpdHRlcpMAsEgAAABXelRYdFJhdyBwcm9maWxlIHR5cGUgaXB0YwAAeJzj8gwIcVYoKMpPy8xJ5VIAAyMLLmMLEyMTS5MUAxMgRIA0w2QDI7NUIMvY1MjEzMQcxAfLgEigSi4A6hcRdPJCNZUAAAAASUVORK5CYII=" data-reactid="14"/></a></li><li style="display:inline-block;margin-right:1rem;" data-reactid="15"><a href="https://github.com//alexisjanvier" data-reactid="16"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAQAAADZc7J/AAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAAAjcAAAI3AfcGRMIAAAAHdElNRQfhCQEKFycJftO4AAAC2ElEQVRIx62VTUhUURTHf/c10/hJ+VH6wtqVWhi0qHEhItIiKhzbtCncRFSLWQhRJubrjTqLXAjZoqKPlVA7B0JXCUIIOqiLIkcNizRGEfxoBptpdF6LefPmOTM5Cp3NOx/3/7/3nHfPPUIjVXptq/Wag0pkZMCPnynhKRhyhlPXimQCtxxp5xr5aXgD9Fldrf4dCNQs2mgmh3/LBj10KqG0BGop/djZWZYpZoxGZTHukOJKRxVe7CyTi4O3bKTZ+zV25TAj2PF2VCWdQC3FSxkwrVQAPM7/7RRLzO2bs6yFiigWR7Vx5TuA+pIbwAJnY6ew6Ln3U2be7l4At2GsM8eYseO0BlBGv1qnhOIptGXMPSFR/WunTa+BW6bZCE9mwmuvmNfVZrcMEkTajR8XsrRkIlDWxANdzYm0g3hiW1k2rs0L5VbmHHptK8FY7QgUHpJW6023bj4zHJxhvuhq/mq9pDlMsbVdFtK4JZpDojLhF7m7JMgztEoJ2VThwj0TyBZkQCPICjMs7ZLgJ0EKKMGCHO+FLbKpoEE9kRmtXmCdTfbHLqF4NMNxU/QH9kSnpYWfY4Aiw5yV2P5AHGPCdWnH3T+Y4OC3MEWtbgQZ5DKy9l79iEcajM4qfwxglnQm6uAKySlOScKTqK0YphofUEN39DPXE+vEjegI91PgCI9UMEQgbmrd0pbUxCwAXuVNYqH2HF+ajAIFQ5IzTJ/hyI6+s36lDid3qEVTs0C9C2qOssl4GoI+Z9gCVlekyejHU+FnttstT3XrJBPkAdUM8SsFvmF1gQStfnpM7qvhb6pP9bluAqd1Xw0kEjWkp9Uff5E6GTUFDlBOuVYEokT3HOm1kTxARukEnUAJ0chCaoqaiGsrgqxtoQUaY9PBmAsdVdGBbQ/rOsMcZJDzTNJAIcVmuHTx4Sf9R+5xsMQOn26wgLJIHV1pRsq2ytNFnblb/u9wjctexvtf2qD0QeZRdFEAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTctMDktMDFUMTA6MjM6MzkrMDI6MDDwwQTMAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE3LTA5LTAxVDEwOjIzOjM5KzAyOjAwgZy8cAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAMdEVYdFRpdGxlAEdpdEh1YlTKy1sAAABXelRYdFJhdyBwcm9maWxlIHR5cGUgaXB0YwAAeJzj8gwIcVYoKMpPy8xJ5VIAAyMLLmMLEyMTS5MUAxMgRIA0w2QDI7NUIMvY1MjEzMQcxAfLgEigSi4A6hcRdPJCNZUAAAAASUVORK5CYII=" data-reactid="17"/></a></li></ul></header><div data-reactid="18"><!-- react-empty: 19 --><div class="postIntro" data-reactid="20"><h1 data-reactid="21">Déploiement continu vers S3</h1><p class="date" data-reactid="22"><!-- react-text: 23 -->Publié le <!-- /react-text --><!-- react-text: 24 -->15 février 2016<!-- /react-text --></p><p class="tags" data-reactid="25">AWS,S3,Devops</p><p class="intro" data-reactid="26">L’application « Road to Caen » est maintenant bootstrappée. Avant de commencer le développement proprement, il reste à mettre en place le tunnel de déploiement continu, du code créé en local au bucket S3 d’hébergement, déploiement sécurisé par l’exécution automatique des tests unitaires et fonctionnels déjà mis en place.</p></div><div data-reactid="27"><h1>Hébergement du site sur S3</h1>
<p>L’un des objectifs du projet est de réaliser une application <strong>serverless</strong>. Pour <strong><em>Road to Caen</em></strong>, ce ne devrait pour l’instant pas être compliqué, l’application ne consistant qu’en une application JavaScript. Il suffira donc d’héberger les fichiers statiques sur un Bucket S3, configuré pour pouvoir servir ses fichiers en HTTP.</p>
<p>La manipulation est très simple, et <a href="http://docs.aws.amazon.com/fr_fr/AmazonS3/latest/dev/WebsiteHosting.html">la documentation</a> permet de rapidement mettre en place notre « infrastructure »</p>
<p>Je vais juste revenir sur les points qui me semblent les plus importants.</p>
<h3>- Nommage du bucket</h3>
<p>Il faut donner le même nom au bucket que l’url du site. Par exemple pour une url <strong>mon<em>site. mon</em>domaine.com</strong>, on nommera le bucket... <strong>mon<em>site. mon</em>domaine.com</strong></p>
<h3>- Création d'un utilisateur IAM, et d'une <em>Policies</em> spécifique pour le bucket</h3>
<p>Ensuite, il est <strong>obligatoire</strong> de créer un utilisateur IAM pour interagir avec notre bucket, afin d’être certain de ne jamais utiliser <strong>l’aws<em>access</em>key_id</strong> et <strong>l’aws<em>secret</em>access_key</strong> de l’utilisateur principal du compte AWS (le root en quelque sorte). Certains s’en sont mordu les doigts.</p>
<div class="gatsby-highlight">
      <pre class="language-none"><code># Policies appliquée au user IAM
 {
    "Version": "2012-10-17",
    "Statement": [
        {
            "Sid": "Stmt1453976839000",
            "Effect": "Allow",
            "Action": [
                "s3:PutObject",
                "s3:PutObjectAcl",
                "s3:DeleteObject",
                "s3:AddObject"
            ],
            "Resource": [
                "arn:aws:s3:::mon_site.mon_domaine.com/*"
            ]
        }
    ]
}</code></pre>
      </div>
<h3>- Ajout d'une entrée CNAM au DNS de son domaine</h3>
<p>Il faut ajouter une entrée CNAM dans les réglages DNS de son domaine.</p>
<div class="gatsby-highlight">
      <pre class="language-none"><code>mon_site CNAME mon_site.mon_domaine.com.s3-website-eu-west-1.amazonaws.com.</code></pre>
      </div>
<h1>Déploiement manuel</h1>
<p>Avant de configurer le déploiement automatique, on va tout de même configurer de quoi déployer <em>à la main</em> notre code sur S3.
Pour cela, il faut tout d'abord installer <a href="https://aws.amazon.com/fr/cli/">awscli</a>. Sur un Mac, on peut utiliser <a href="http://brew.sh/">brew</a> :</p>
<div class="gatsby-highlight">
      <pre class="language-bash"><code>brew <span class="token function">install</span> awscli
</code></pre>
      </div>
<p>Ensuite, on configure un profil spécifique au projet, avec les identifiants de l'utilisateur IAM précédemment créé :</p>
<div class="gatsby-highlight">
      <pre class="language-none"><code># ~/.aws/config

[default]
output = json
region = us-east-1

[profile IAM_USER_PROFIL]
output = json
region = eu-west-1
aws_access_key_id = IAM_USER_ACCESS_KEY_ID
aws_secret_access_key = IAM_USER_SECRET_ACCESS_KEY</code></pre>
      </div>
<p>Ne reste plus qu'à ajouter une nouvelle commande à notre fichier <code>makefile</code>:</p>
<div class="gatsby-highlight">
      <pre class="language-makefile"><code><span class="token comment" spellcheck="true"># makefile</span>

<span class="token symbol">deploy</span><span class="token punctuation">:</span> build
    <span class="token operator">@</span> echo <span class="token string">'* Deploy web app on S3 *'</span>
    aws s3 --profile<span class="token operator">=</span>IAM_USER_PROFIL --region<span class="token operator">=</span>eu-west-1 sync ./build/ s3<span class="token punctuation">:</span>//YOUR-BUCKET-NAME/ --delete
</code></pre>
      </div>
<h1>Worflow de développement et intégration continue</h1>
<p>Le worflow de développement sera très simple; c'est d'ailleurs celui que je trouve le meilleur, même sur les projets plus importants :</p>
<ul>
<li>une branche master qui contient le code envoyé sur S3,</li>
<li>une nouvelle branche par feature développée.</li>
</ul>
<p>Une fois la feature terminée, elle est intégrée à la branche master via une pull request. C'est à ce moment que l'on va parler d'intégration continue, car cette PR va être automatiquement testée sur <a href="https://travis-ci.org"><strong>Travis</strong></a>. Il suffit pour cela d'ajouter le fichier <code>.travis.yml</code> à la racine du projet :</p>
<div class="gatsby-highlight">
      <pre class="language-yaml"><code><span class="token comment" spellcheck="true"># .travis.yml</span>

<span class="token key atrule">language</span><span class="token punctuation">:</span> node_js

<span class="token key atrule">node_js</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token string">"5.5"</span>

<span class="token key atrule">env</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> CXX=g++<span class="token punctuation">-</span><span class="token number">4.8</span>

<span class="token key atrule">sudo</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>

<span class="token key atrule">addons</span><span class="token punctuation">:</span>
    <span class="token key atrule">apt</span><span class="token punctuation">:</span>
        <span class="token key atrule">sources</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> ubuntu<span class="token punctuation">-</span>toolchain<span class="token punctuation">-</span>r<span class="token punctuation">-</span>test
        <span class="token key atrule">packages</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> gcc<span class="token punctuation">-</span><span class="token number">4.8</span>
            <span class="token punctuation">-</span> g++<span class="token punctuation">-</span><span class="token number">4.8</span>

<span class="token key atrule">cache</span><span class="token punctuation">:</span>
    <span class="token key atrule">directories</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> node_modules

<span class="token key atrule">before_script</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> cp <span class="token punctuation">-</span>n ./config/test.js.dist ./config/test.js <span class="token punctuation">|</span> true

<span class="token comment" spellcheck="true"># xvfb va permettre de lancer firefox, utilisé pour les tests fonctionnels</span>
<span class="token comment" spellcheck="true"># sans avoir à installer un serveur X</span>
<span class="token key atrule">before_install</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token string">"export DISPLAY=:99.0"</span>
    <span class="token punctuation">-</span> <span class="token string">"sh -e /etc/init.d/xvfb start"</span>

<span class="token key atrule">install</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token string">"make --silent install"</span>
</code></pre>
      </div>
<p>Pour un projet en node, Travis va lancer le script de test déclaré dans le <code>package.json</code>:</p>
<div class="gatsby-highlight">
      <pre class="language-json"><code><span class="token property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token property">"test"</span><span class="token operator">:</span> <span class="token string">"make test"</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre>
      </div>
<p>Il faut évidemment déclarer le dépôt git du projet sur le site de Travis, pour qu'il puisse mettre en place les webhooks lui permettant de savoir quand une PR est réalisée. Travis est gratuit pour les dépôts publics.</p>
<h1>Déploiement continu</h1>
<p>Pour finir, on va automatiser le déploiement du code sur notre Bucket S3, lorsque la PR  (passée <em>au vert</em> sur Travis) est mergée sur la branche <strong>master</strong>. Pour cela, j'utilise <a href="https://snap-ci.com"><strong>Snap CI</strong></a> (mais il en existe d'autres), qui est tout comme Travis gratuit pour les dépôts git public. L'interface est bien réalisée, et permet de monter un <strong><em>pipeline</em></strong> d'étapes, dont une réalisant le déploiement sur S3. Une étape peut également consistée à lancer les tests une dernière fois avant de déployer, au cas où ...</p>
<p><img src="/images/rtc_deployment/snapCiRTC.png" alt="Road to Caen Pipeline"></p>
<h1>C'est prêt !</h1>
<p>Et voilà, on peut commencer à coder en ES6 sur une <strong>nouvelle branche</strong>. Une fois une feature terminée et <strong>testée</strong>, on propose le code via une <strong>PR sur Github</strong>. Si les tests passent tous sur <strong>Travis</strong>, on <strong>merge</strong> la PR, et <strong><em>tadam</em></strong>, le code est directement envoyé sur <strong>S3</strong> grâce à <strong>Snap CI</strong> et accessible à la terre entière.</p></div></div></div></div></body></html>